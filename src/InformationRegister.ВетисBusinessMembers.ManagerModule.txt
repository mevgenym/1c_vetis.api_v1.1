
Процедура Добавить(BusinessEntity, Enterprise, пСвой = Неопределено, пВСервисе = Неопределено, пИспользовать = Истина) Экспорт
	
	Изменить(BusinessEntity, Enterprise, пСвой, пВСервисе, пИспользовать);
	
КонецПроцедуры

Процедура Изменить(BusinessEntity, Enterprise, пСвой = Неопределено, пВСервисе = Неопределено, пИспользовать = Неопределено) Экспорт
	
	_ШаблонСообщения = "ВетисBusinessMembers.Изменить: Параметр ""%1"" должен иметь тип %2";
	_ТекстСообщения = "";
	
	Если Ложь Тогда
	ИначеЕсли НЕ Enterprise = Неопределено И НЕ ТипЗнч(Enterprise) = Тип("СправочникСсылка.ВетисEnterprise") Тогда
		_ТекстСообщения = ВетисСтроковыеФункции._СтрШаблон(_ШаблонСообщения, "Enterprise", "СправочникСсылка.ВетисEnterprise");
	ИначеЕсли НЕ BusinessEntity = Неопределено И НЕ ТипЗнч(BusinessEntity) = Тип("СправочникСсылка.ВетисBusinessEntity") Тогда
		_ТекстСообщения = ВетисСтроковыеФункции._СтрШаблон(_ШаблонСообщения, "BusinessEntity", "СправочникСсылка.ВетисBusinessEntity");
	КонецЕсли;
	
	Если НЕ _ТекстСообщения = "" Тогда
		ВетисОбщегоНазначения.ВывестиСообщение(_ТекстСообщения);
		ВызватьИсключение _ТекстСообщения;
	КонецЕсли;
	
	_мз = РегистрыСведений.ВетисBusinessMembers.СоздатьМенеджерЗаписи();
	_мз.BusinessEntity = BusinessEntity;
	_мз.Enterprise = Enterprise;
	
	_мз.Прочитать();
	
	_мз.BusinessEntity = BusinessEntity;
	_мз.Enterprise   = Enterprise;
	_мз.Использовать = ?(пИспользовать = Неопределено, _мз.Использовать, пИспользовать);
	_мз.Свой         = ?(пСвой = Неопределено, _мз.Свой, пСвой);
	_мз.ВСервисе     = ?(пВСервисе = Неопределено, _мз.ВСервисе, пВСервисе);
	_мз.Записать();
	
КонецПроцедуры

Процедура Удалить(BusinessEntity, Enterprise) Экспорт
	
	_мз = РегистрыСведений.ВетисBusinessMembers.СоздатьМенеджерЗаписи();
	_мз.BusinessEntity = BusinessEntity;
	_мз.Enterprise = Enterprise;
	_мз.Удалить();
	
КонецПроцедуры
