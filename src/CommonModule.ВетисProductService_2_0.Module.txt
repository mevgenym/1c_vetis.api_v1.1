
// Предназначена для получения записи продукции
Функция GetProductByGuid(guid, пОтказ = Ложь, пОшибка = "", пВызватьИсключение = Ложь) Экспорт
	
	Попытка
		Возврат Прокси().GetProductByGuid(guid);
	Исключение
		пОтказ = Истина;
		пОшибка = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ВетисОбщегоНазначения.ВывестиСообщениеОбОшибке(ИнформацияОбОшибке(), "GetProductByGuid");
		Если пВызватьИсключение = Истина Тогда ВызватьИсключение; КонецЕсли;
	КонецПопытки;
	
КонецФункции

// Предназначена для получения записи о виде продукции
Функция GetSubProductByGuid(guid, пОтказ = Ложь, пОшибка = "", пВызватьИсключение = Ложь) Экспорт
	
	Попытка
		Возврат Прокси().GetSubProductByGuid(guid);
	Исключение
		ВетисОбщегоНазначения.ВывестиСообщениеОбОшибке(ИнформацияОбОшибке(), "GetSubProductByGuid");
		пОтказ = Истина;
		пОшибка = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		Если пВызватьИсключение = Истина Тогда ВызватьИсключение; КонецЕсли;
	КонецПопытки;
	
КонецФункции

// предназначена для получения записи о номенклатуре производителя
Функция GetProductItemByGuid(guid, пОтказ = Ложь, пОшибка = "", пВызватьИсключение = Истина) Экспорт
	
	Если Ветис.Настройки_ОберткаHttp() Тогда
		Возврат ВетисRegistry_2_0.getProductItemByGuid(guid, пОтказ, пОшибка);
	КонецЕсли;
	
	Попытка
		Возврат Прокси().GetProductItemByGuid(guid);
	Исключение
		пОтказ = Истина;
		пОшибка = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ВетисОбщегоНазначения.ВывестиСообщениеОбОшибке(ИнформацияОбОшибке(), "GetProductItemByGuid");
		Если пВызватьИсключение = Истина Тогда ВызватьИсключение; КонецЕсли;
	КонецПопытки;
	
КонецФункции

Функция GetProductItemByUuid(uuid, пОтказ = Ложь, пОшибка = "", пВызватьИсключение = Истина) Экспорт
	
	//Если Ветис.Настройки_ОберткаHttp() Тогда
	//	Возврат ВетисRegistry_2_0.getProductItemByUuid(uuid, пОтказ, пОшибка);
	//КонецЕсли;
	
	Попытка
		Возврат Прокси().GetProductItemByUuid(uuid);
	Исключение
		пОтказ = Истина;
		пОшибка = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ВетисОбщегоНазначения.ВывестиСообщениеОбОшибке(ИнформацияОбОшибке(), "GetProductItemByUuid");
		Если пВызватьИсключение = Истина Тогда ВызватьИсключение; КонецЕсли;
	КонецПопытки;
	
КонецФункции


// Предназначена для Выборки продукции по указанному типу.
// Используется самостоятельно в цикле Пока.
// Параметры:
//  productType - тип продукта
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//	Булево - Ложь значит список пройден весь
Функция GetProductByTypeListNext(productType, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetProductByTypeList", "product", "", пПараметры,	productType);
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции

// Предназначена для выборки видов продукции, отфильтрованного по указанному продукту.
// Используется самостоятельно в цикле Пока.
// Параметры:
//  productGuid - ссылка на продукт
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//	Булево - Ложь значит список пройден весь
Функция GetSubProductByProductListNext(productGuid, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetSubProductByProductList", "subProduct", "", пПараметры, productGuid);
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции

// Предназначена для получения списка наименований продукции с возможностью фильтрации по уровням продукции иерархического справочника,
//  по номенклатуре определенного предприятия-производителя или всех предприятий определенного хозяйствующего субъекта.
// Используется самостоятельно в цикле Пока.
// Параметры:
//  productType - Тип продукции
//  product - Продукция
//  subProduct - Вид продукции
//  businessEntity - Данные о хозяйствующем субъекте
//  enterprise - Данные о предприятии-производителе продукции
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//  Булево - Ложь значит список пройден весь
Функция GetProductItemListNext(productType, product, subProduct, businessEntity, enterprise, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	пПараметры = ?(пПараметры = Неопределено, Новый Структура, пПараметры);
	
	Если Ветис.Настройки_ОберткаHttp() ИЛИ пПараметры.Свойство("ОберткаHttp") Тогда
		Возврат ВетисRegistry_2_0.getProductItemListNext(productType, product, subProduct, businessEntity, enterprise, Item, пПараметры, пОтказ, пОшибка);
	КонецЕсли;
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetProductItemList", "productItem", "", пПараметры,
			productType, product, subProduct, businessEntity, enterprise);
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции


// Предназначена для получения списка изменённой продукции
// Используется самостоятельно в цикле Пока.
// Параметры:
//  beginDate - Начальная дата интервала xs:dateTime
//  endDate - Конечная дата интервала xs:dateTime
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//	Булево - Ложь значит список пройден весь
Функция GetProductChangesListNext(beginDate, endDate = Неопределено, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	//Если Ветис.Настройки_ОберткаHttp() Тогда
	//	Возврат ВетисRegistry_2_0.getProductChangesListNext(beginDate, endDate, product, пПараметры, пОтказ, пОшибка);
	//КонецЕсли;
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetProductChangesList", "product", "", пПараметры,
			ВетисBase_2_0.DateInterval(beginDate, endDate));
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции

// Предназначена для получения списка изменённых видов продукции
// Используется самостоятельно в цикле Пока.
// Параметры:
//  beginDate - Начальная дата интервала xs:dateTime
//  endDate - Конечная дата интервала xs:dateTime
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//	Булево - Ложь значит список пройден весь
Функция GetSubProductChangesListNext(beginDate, endDate = Неопределено, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	//Если Ветис.Настройки_ОберткаHttp() Тогда
	//	Возврат ВетисRegistry_2_0.getSubProductChangesListNext(beginDate, endDate, subProduct, пПараметры, пОтказ, пОшибка);
	//КонецЕсли;
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetSubProductChangesList", "subProduct", "", пПараметры,
			ВетисBase_2_0.DateInterval(beginDate, endDate));
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции

// Предназначена для получения изменений в списке наименований продукции для номенклатуры предприятия-производителя
// Используется самостоятельно в цикле Пока.
// Параметры:
//  enterpriseGuid - Идентификатор предприятия, на котором производится или хранится продукция bs:UUID
//  beginDate - Начальная дата интервала xs:dateTime
//  endDate - Конечная дата интервала xs:dateTime
//  Item - элемент списка, возвращаемый параметр
//  пПараметры - для внутреннего использования, начальное значение - Неопределено
// Возвращаемое значение:
//	Булево - Ложь значит список пройден весь
Функция GetProductItemChangesListNext(businessEntity = Неопределено, enterprise = Неопределено, beginDate = Неопределено, endDate = Неопределено, Item, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	пПараметры = ?(пПараметры = Неопределено, Новый Структура, пПараметры);
	
	Если Ветис.Настройки_ОберткаHttp() ИЛИ пПараметры.Свойство("ОберткаHttp") Тогда
		Возврат ВетисRegistry_2_0.getProductItemChangesListNext(businessEntity, enterprise, beginDate, endDate, Item, пПараметры, пОтказ, пОшибка);
	КонецЕсли;
	
	Если Ветис.ВыборкаСпискаЭтоНачало(пПараметры) Тогда
		Ветис.ВыборкаСпискаИнициализация(ИмяСервиса(), "GetProductItemChangesList", "productItem", "", пПараметры,
			ВетисBase_2_0.DateInterval(beginDate, endDate), businessEntity, enterprise);
	КонецЕсли;
	
	Возврат Ветис.ВыборкаСпискаСледующий(Item, пПараметры, пОтказ, пОшибка);
	
КонецФункции


Функция ИмяСервиса() Экспорт
	
	Возврат Перечисления.ВетисСервис.ProductService;
	
КонецФункции

Функция Прокси()
	
	Возврат ВетисПовтИсп.Прокси(ИмяСервиса());
	
КонецФункции
