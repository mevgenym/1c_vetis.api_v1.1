
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ОсновнаяНастройка        = ВетисПовтИсп.Настройки_ОсновнаяНастройка();
	ОсновнойПользователь     = Ветис.Настройки_ОсновнойПользователь();
	//ОсновнойХС               = Ветис.Настройки_ОсновнойХС();
	
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	
	Если Модифицированность Тогда
		_Ответ = Вопрос("Записать изменения?", РежимДиалогаВопрос.ДаНетОтмена);
		Если _Ответ = КодВозвратаДиалога.Да Тогда
			КомандаГотовоНаСервере();
		ИначеЕсли _Ответ = КодВозвратаДиалога.Отмена Тогда
			Отказ = Истина;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры


&НаКлиенте
Процедура КомандаГотово(Команда)
	
	КомандаГотовоНаСервере();
	
	Оповестить("ВетисНастройки");
	
	ОбновитьИнтерфейс();
	
	Закрыть();
	
КонецПроцедуры

&НаСервере
Процедура КомандаГотовоНаСервере()
	
	ВетисПовтИсп.Настройки_ОсновнаяНастройка(ОсновнаяНастройка);
	Ветис.Настройки_ОсновнойПользователь(ОсновнойПользователь);
	//Ветис.Настройки_ОсновнойХС(ОсновнойХС);
	
	Ветис.ИнициализироватьНастройкиПодключения();
	
	Модифицированность = Ложь;
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОсновнаяНастройка(Команда)
	
	ОсновнаяНастройка = Элементы.НастройкиПодключения.ТекущиеДанные.Ссылка;
	
	Модифицированность = Истина;
	
	Элементы.НастройкиПодключения.Обновить();
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОсновнойПользователь(Команда)
	
	Если НЕ Элементы.СписокПользователи.ТекущиеДанные = Неопределено Тогда
		
		ОсновнойПользователь = Элементы.СписокПользователи.ТекущиеДанные.Ссылка;
		
		Модифицированность = Истина;
		
		Элементы.СписокПользователи.Обновить();
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаЗаполнитьXSD(Команда)
	
КонецПроцедуры
