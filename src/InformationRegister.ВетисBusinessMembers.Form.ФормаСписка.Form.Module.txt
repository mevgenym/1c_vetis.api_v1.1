
&НаКлиенте
Процедура КомандаПривязатьВСервисе(Команда)
	
	Перем _Отказ, _Ошибка;
	
	ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	ModifyActivityLocations(ТекущиеДанные.BusinessEntity, ТекущиеДанные.Enterprise, Истина, _Отказ, _Ошибка);
	
	Если _Отказ = Истина Тогда
		Сообщить(_Ошибка);
		Возврат;
	КонецЕсли;
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие(, _Отказ, _Ошибка);
	
	Если _Отказ = Истина Тогда
		Сообщить(_Ошибка);
		Возврат;
	КонецЕсли;
	
	Элементы.Список.Обновить();
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОтвязатьВСервисе(Команда)
	
	Перем _Отказ, _Ошибка;
	
	ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	ModifyActivityLocations(ТекущиеДанные.BusinessEntity, ТекущиеДанные.Enterprise, Ложь, _Отказ, _Ошибка);
	
	Если _Отказ = Истина Тогда
		Сообщить(_Ошибка);
		Возврат;
	КонецЕсли;
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие(, _Отказ, _Ошибка);
	
	Если _Отказ = Истина Тогда
		Сообщить(_Ошибка);
		Возврат;
	КонецЕсли;
	
	Элементы.Список.Обновить();
	
КонецПроцедуры

&НаСервере
Процедура ModifyActivityLocations(пХозяйствующийСубъект, пПредприятие, CREATE = Истина, пОтказ = Ложь, пОшибка = "")
	
	ВетисMercuryApplicationsСлой1с.ModifyActivityLocations(пХозяйствующийСубъект, пПредприятие, CREATE, пОтказ, пОшибка);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОбновитьХСПредприятие(Команда)
	
	Перем _Отказ, _Ошибка;
	
	ВетисХозяйственныеОперации.ОбновитьСвязиХСПредприятие(, _Отказ, _Ошибка);
	
	Если _Отказ = Истина Тогда
		Сообщить(_Ошибка);
		Возврат;
	КонецЕсли;
	
	Элементы.Список.Обновить();
	
КонецПроцедуры
