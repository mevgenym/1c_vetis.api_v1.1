
&НаКлиенте
Процедура КомандаУстановить(Команда)
	
	ПоказатьВводДаты(Новый ОписаниеОповещения("ОбработкаОповещения", ЭтаФорма), ТекущаяДата());
	
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаОповещения(Результат, Параметр) Экспорт
	
	Если ЗначениеЗаполнено(Результат) Тогда
		Установить(Результат);
		Элементы.Список.Обновить();
	КонецЕсли;
	
КонецПроцедуры


Процедура Установить(пГраница)
	
	Для каждого _Строка Из Элементы.Список.ВыделенныеСтроки Цикл
		_мз = РегистрыСведений.ВетисГраницыЗапросов.СоздатьМенеджерЗаписи();
		_мз.Операция = _Строка.Операция;
		_мз.BusinessEntity = _Строка.BusinessEntity;
		_мз.Enterprise = _Строка.Enterprise;
		_мз.Граница = пГраница;
		_мз.Записать();
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаНастроитьСвязь(Команда)
	
	_ТекущиеДанные = Элементы.Список.ТекущиеДанные;
	
	Если _ТекущиеДанные = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ОткрытьФорму("РегистрСведений.ВетисBusinessMembers.ФормаЗаписи", ПолучитьПараметры(_ТекущиеДанные.BusinessEntity, _ТекущиеДанные.Enterprise));
	
КонецПроцедуры

&НаСервере
Функция ПолучитьПараметры(pBusinessEntity, pEnterprise)
	
	_Запись = РегистрыСведений.ВетисBusinessMembers.СоздатьМенеджерЗаписи();
	_Запись.BusinessEntity = pBusinessEntity;
	_Запись.Enterprise = pEnterprise;
	_Запись.Прочитать();
	
	Если _Запись.Выбран() Тогда
		Возврат Новый Структура("Ключ", РегистрыСведений.ВетисBusinessMembers.СоздатьКлючЗаписи(Новый Структура("BusinessEntity, Enterprise", pBusinessEntity, pEnterprise)));
	Иначе
		Возврат Новый Структура("BusinessEntity, Enterprise", pBusinessEntity, pEnterprise);
	КонецЕсли;
	
КонецФункции
