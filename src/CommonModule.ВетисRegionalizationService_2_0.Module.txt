
//Используется самостоятельно в цикле Пока.
//Параметры:
// disease - Заболевание, к которому относятся запрашиваемые условия перемещения груза. bs:String255 0..1
// пУсловие - элемент списка, возвращаемый параметр
// пПараметры - для внутреннего использования, начальное значение - Неопределено
//Возвращаемое значение:
// Булево - Ложь значит список пройден весь
Функция GetR13nConditionListNext(пЗаболевание = Неопределено, пУсловие, пПараметры, пОтказ = Ложь, пОшибка = "") Экспорт
	
	Если Ветис.Настройки_ОберткаHttp() Тогда
		Возврат ВетисRegistry_2_0.GetR13nConditionListNext(пЗаболевание, пУсловие, пПараметры, пОтказ, пОшибка);
	КонецЕсли;
	
	Если пПараметры = Неопределено Тогда
		пПараметры = Новый Структура;
		//2017-11-24
		//их там около 600, если ставить меньше, то при втором обращении со смещением идет ошибка
		пПараметры.Вставить("ListOptions", ВетисBase_2_0.ListOptions(1000));
		пПараметры.Вставить("AnimalDisease", ВетисDictionary_2_0.AnimalDisease(пЗаболевание));
		пПараметры.Вставить("Индекс", 0);
	Иначе
		пПараметры.Индекс = пПараметры.Индекс + 1;
		Если пПараметры.Индекс >= пПараметры.ListResponse.count Тогда
			Если пПараметры.ListOptions.offset + пПараметры.ListOptions.count >= Число(пПараметры.ListResponse.Total) Тогда
				Возврат Ложь;
			Иначе
				пПараметры.ListOptions.offset = пПараметры.ListOptions.offset + пПараметры.ListOptions.count;
				пПараметры.Индекс = 0;
			КонецЕсли;
		Иначе
			пУсловие = пПараметры.ListResponse.condition[пПараметры.Индекс];
			Возврат Истина;
		КонецЕсли;
	КонецЕсли;
	
	Попытка
		ListResponse = Прокси().GetR13nConditionList(пПараметры.ListOptions, пПараметры.AnimalDisease);
	Исключение
		пОтказ = Истина;
		пОшибка = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ВетисОбщегоНазначения.ВывестиСообщениеОбОшибке(ИнформацияОбОшибке(), "GetR13nConditionListNext");
		ВызватьИсключение;
	КонецПопытки;
	
	пПараметры.Вставить("ListResponse", ListResponse);
	
	Если пПараметры.Индекс >= пПараметры.ListResponse.count Тогда
		Возврат Ложь;
	Иначе
		пУсловие = пПараметры.ListResponse.condition[пПараметры.Индекс];
		Возврат Истина;
	КонецЕсли;
	
	Возврат Истина;
	
КонецФункции


Функция ИмяСервиса() Экспорт
	
	Возврат Перечисления.ВетисСервис.RegionalizationService;
	
КонецФункции

Функция Прокси()
	
	_Прокси = ВетисПовтИсп.Прокси(ИмяСервиса());
	
	Возврат _Прокси;
	
КонецФункции
